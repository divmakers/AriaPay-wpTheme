<?php 

get_header();
?>


<section class="bg-blue-11 dark:bg-dark-50">
      <div class="container relative">
        <!-- BreadCrump Start -->
        <div class="flex items-center mt-[60px] md:mt-[116px] md:pt-[36px] pt-[11px]">
          <svg xmlns="http://www.w3.org/2000/svg" width="26" height="27" viewBox="0 0 26 27" fill="none" class="hidden md:block dark:hidden">
            <path d="M2.86207 14.5145C2.46029 11.7222 2.25939 10.326 2.83167 9.13228C3.40396 7.93856 4.62205 7.21295 7.05823 5.76173L8.5246 4.88822C10.7369 3.57037 11.8431 2.91144 13.0653 2.91144C14.2876 2.91144 15.3938 3.57037 17.6061 4.88822L19.0724 5.76173C21.5086 7.21295 22.7267 7.93856 23.299 9.13228C23.8713 10.326 23.6704 11.7222 23.2686 14.5145L22.9734 16.5659C22.4573 20.1528 22.1992 21.9462 20.955 23.0176C19.7107 24.089 17.886 24.089 14.2365 24.089H11.8941C8.24465 24.089 6.41992 24.089 5.17567 23.0176C3.93142 21.9462 3.67336 20.1528 3.15725 16.5659L2.86207 14.5145Z" stroke="#4F4F4F" stroke-width="1.58831"></path>
            <path d="M9.88477 17.7355C10.7852 18.4029 11.8803 18.7944 13.0614 18.7944C14.2425 18.7944 15.3376 18.4029 16.238 17.7355" stroke="#4F4F4F" stroke-width="1.58831" stroke-linecap="round"></path>
          </svg>
          <svg class="block md:hidden dark:hidden" xmlns="http://www.w3.org/2000/svg" width="16" height="17" viewBox="0 0 16 17" fill="none">
            <path d="M1.57865 9.13871C1.32569 7.38067 1.19921 6.50166 1.55952 5.7501C1.91982 4.99853 2.68673 4.54169 4.22055 3.62801L5.14377 3.07805C6.53663 2.24833 7.23306 1.83347 8.0026 1.83347C8.77214 1.83347 9.46858 2.24833 10.8614 3.07804L11.7847 3.628C13.3185 4.54169 14.0854 4.99853 14.4457 5.7501C14.806 6.50166 14.6795 7.38068 14.4266 9.13871L14.2407 10.4303C13.9158 12.6886 13.7533 13.8177 12.9699 14.4923C12.1865 15.1668 11.0377 15.1668 8.73999 15.1668H7.26522C4.96752 15.1668 3.81867 15.1668 3.03529 14.4923C2.25191 13.8177 2.08944 12.6886 1.7645 10.4303L1.57865 9.13871Z" stroke="#4F4F4F"></path>
            <path d="M6 11.1667C6.56692 11.5869 7.25638 11.8333 8 11.8333C8.74362 11.8333 9.43308 11.5869 10 11.1667" stroke="#4F4F4F" stroke-linecap="round"></path>
          </svg>
          <svg class="hidden dark:block" xmlns="http://www.w3.org/2000/svg" width="26" height="27" viewBox="0 0 26 27" fill="none">
            <path d="M2.86207 14.5145C2.46029 11.7222 2.25939 10.326 2.83167 9.13228C3.40396 7.93856 4.62205 7.21295 7.05823 5.76173L8.5246 4.88822C10.7369 3.57037 11.8431 2.91144 13.0653 2.91144C14.2876 2.91144 15.3938 3.57037 17.6061 4.88822L19.0724 5.76173C21.5086 7.21295 22.7267 7.93856 23.299 9.13228C23.8713 10.326 23.6704 11.7222 23.2686 14.5145L22.9734 16.5659C22.4573 20.1528 22.1992 21.9462 20.955 23.0176C19.7107 24.089 17.886 24.089 14.2365 24.089H11.8941C8.24465 24.089 6.41992 24.089 5.17567 23.0176C3.93142 21.9462 3.67336 20.1528 3.15725 16.5659L2.86207 14.5145Z" stroke="#CDCDCD" stroke-width="1.58831"></path>
            <path d="M9.88477 17.7355C10.7852 18.4029 11.8803 18.7944 13.0614 18.7944C14.2425 18.7944 15.3376 18.4029 16.238 17.7355" stroke="#CDCDCD" stroke-width="1.58831" stroke-linecap="round"></path>
          </svg>
          <a href="<?=get_site_url();?>" alt="آریا پی" class="mr-[10px] dark:text-gray-500 text-black-15 font-semibold text-[12px] md:text-[19px] leading-[27px]">
            آریا پی
          </a>
          
          <svg class="mr-[11px] hidden md:block dark:hidden" xmlns="http://www.w3.org/2000/svg" width="26" height="27" viewBox="0 0 26 27" fill="none">
            <path d="M16.1775 6.08789L9.82422 13.5L16.1775 20.9122" stroke="#4F4F4F" stroke-width="1.58831" stroke-linecap="round" stroke-linejoin="round"></path>
          </svg>
          <svg class="block md:hidden mr-[7px] dark:hidden" xmlns="http://www.w3.org/2000/svg" width="16" height="17" viewBox="0 0 16 17" fill="none">
            <path d="M10 3.83334L6 8.50001L10 13.1667" stroke="#4F4F4F" stroke-linecap="round" stroke-linejoin="round"></path>
          </svg>
          <svg class="hidden dark:block mr-[7px] md:mr-[11px]" xmlns="http://www.w3.org/2000/svg" width="26" height="27" viewBox="0 0 26 27" fill="none">
            <path d="M16.1775 6.08786L9.82422 13.5L16.1775 20.9121" stroke="#CDCDCD" stroke-width="1.58831" stroke-linecap="round" stroke-linejoin="round"></path>
          </svg>
          <?php 
            $post_type = get_post_type();
            if ( $post_type ) :
                $post_type_obj = get_post_type_object( $post_type );
          ?>
          <a href="<?= get_post_type_archive_link( $post_type ); ?>" class="mr-[14px] text-black-11 dark:text-dark-43 text-[12px] md:text-[19px] leading-[27px] font-semibold">
            <?= esc_html( $post_type_obj->labels->singular_name ); ?>
          </a>
          <svg class="mr-[11px] hidden md:block dark:hidden" xmlns="http://www.w3.org/2000/svg" width="26" height="27" viewBox="0 0 26 27" fill="none">
            <path d="M16.1775 6.08789L9.82422 13.5L16.1775 20.9122" stroke="#4F4F4F" stroke-width="1.58831" stroke-linecap="round" stroke-linejoin="round"></path>
          </svg>
          <svg class="block md:hidden mr-[7px] dark:hidden" xmlns="http://www.w3.org/2000/svg" width="16" height="17" viewBox="0 0 16 17" fill="none">
            <path d="M10 3.83334L6 8.50001L10 13.1667" stroke="#4F4F4F" stroke-linecap="round" stroke-linejoin="round"></path>
          </svg>
          <svg class="hidden dark:block mr-[7px] md:mr-[11px]" xmlns="http://www.w3.org/2000/svg" width="26" height="27" viewBox="0 0 26 27" fill="none">
            <path d="M16.1775 6.08786L9.82422 13.5L16.1775 20.9121" stroke="#CDCDCD" stroke-width="1.58831" stroke-linecap="round" stroke-linejoin="round"></path>
          </svg>
          <?php
            endif;
          ?>
          <p class="hidden md:block mr-[14px] text-black-11 dark:text-dark-43 text-[12px] md:text-[19px] leading-[27px] font-semibold">
            <?php
            $term_id = get_queried_object_id();
            $term_description = term_description($term_id);
            $terms = get_the_terms( get_the_ID(), 'category-'.$post_type );
            if ( $terms && ! is_wp_error( $terms ) ) :
                $term = array_shift( $terms );
                echo esc_html( $term->name );
            endif;
            ?>
          </p>
        </div>
        <!-- BreadCrump End -->
        <div class="flex items-center justify-center mt-[22px] md:mt-11">
          <svg xmlns="http://www.w3.org/2000/svg" width="47" height="47" viewBox="0 0 47 47" fill="none">
            <path d="M3.91699 23.5007C3.91699 16.1153 3.91699 12.4226 6.21132 10.1283C8.50565 7.83398 12.1983 7.83398 19.5837 7.83398H27.417C34.8023 7.83398 38.495 7.83398 40.7893 10.1283C43.0837 12.4226 43.0837 16.1153 43.0837 23.5007C43.0837 30.886 43.0837 34.5787 40.7893 36.873C38.495 39.1673 34.8023 39.1673 27.417 39.1673H19.5837C12.1983 39.1673 8.50565 39.1673 6.21132 36.873C3.91699 34.5787 3.91699 30.886 3.91699 23.5007Z" stroke="#2860E6" stroke-width="3.62064"></path>
            <path opacity="0.5" d="M19.5833 31.334H11.75" stroke="#2860E6" stroke-width="3.62064" stroke-linecap="round"></path>
            <path opacity="0.5" d="M27.417 31.334H24.4795" stroke="#2860E6" stroke-width="3.62064" stroke-linecap="round"></path>
            <path opacity="0.5" d="M3.91699 19.584L43.0837 19.584" stroke="#2860E6" stroke-width="3.62064" stroke-linecap="round"></path>
          </svg>
        </div>
        <h2 class="text-center font-semibold text-[19px] md:text-[30px] dark:text-dark-21 leading-[25px] text-black-7 mt-[22px] md:mt-6">
          <?=esc_html( $term->name )?>
        </h2>
        <div class="flex items-center justify-center mt-[20px] md:mt-6 pb-[80px] md:pb-[62px]">
            <?php if (!empty( $term_description )):?>
          <p class="text-justify font-medium text-sm md:text-lg dark:text-dark-62 leading-[27px] text-black-350">
          <?=$term_description?>
          </p>
            <?php endif; ?>
        </div>
        <div class="absolute w-[calc(100%-32px)] md:w-[calc(100%-100px)] md:right-[50px] lg:right-[100px] 2xl:right-[220px] lg:w-[calc(100%-200px)] 2xl:w-[calc(100%-440px)] bg-white-100 dark:bg-dark-11 py-3 md:py-5 px-2 md:px-6 rounded-lg bottom-[-80px]">
          <form action="<?=get_site_url();?>" class="flex items-stretch md:items-center gap-2 md:gap-[18px] flex-col md:flex-row">
            <div class="flex bg-dark-53 dark:bg-dark-1 items-center gap-5 flex-1 border dark:border-none rounded-lg border-dark-32 py-2 md:py-[10px] px-[14px]">
              <div class="bg-blue-12 p-2 md:p-3 rounded-lg">
                <svg xmlns="http://www.w3.org/2000/svg" width="31" class="hidden md:block" height="30" viewBox="0 0 31 30" fill="none">
                  <circle cx="14.875" cy="14.375" r="11.875" stroke="#2860E6" stroke-width="1.875"></circle>
                  <path d="M23.625 23.125L28 27.5" stroke="#2860E6" stroke-width="1.875" stroke-linecap="round"></path>
                </svg>
                <svg class="block md:hidden" xmlns="http://www.w3.org/2000/svg" width="23" height="23" viewBox="0 0 23 23" fill="none">
                  <circle cx="11.0253" cy="11.0253" r="9.02043" stroke="#2860E6" stroke-width="1.42428"></circle>
                  <path d="M17.6719 17.6719L20.9952 20.9952" stroke="#2860E6" stroke-width="1.42428" stroke-linecap="round"></path>
                </svg>
              </div>
              <input name="s" type="text" class="flex-1 text-[13px] md:text-base bg-transparent focus:outline-none placeholder:text-dark-71 font-semibold placeholder:dark:text-dark-2" placeholder="مطلب مورد نظرتان را جستجو کنید">
            </div>
            <button type="submit" class="font-semibold hover-element-blue cursor-pointer text-sm md:text-lg leading-[27px] text-dark-53 bg-blue-500 py-3 md:py-[22px] px-10 rounded-lg">
              جستجو مطلب
            </button>
          </form>
        </div>
      </div>
    </section>
    <!-- Blogs Start -->
<section class="container">
<?php 
global $wp_query; // Use the global wp_query object

if ($wp_query->have_posts()) : ?>
    <div class="grid grid-cols-12 gap-x-[18px] gap-y-[27px] mt-[102px] md:mt-[132px]">
        <?php while ($wp_query->have_posts()) : $wp_query->the_post(); ?>
            <div class="rounded-[9px] py-4 border border-gray-300 px-3 col-span-12 md:col-span-6 lg:col-span-3 dark:border-none dark:bg-dark-11">
                <a href="<?=get_post_permalink()?>" class="block h-[165px] relative">
                    <?php 
                    // Check if the post has a featured image
                    if (has_post_thumbnail()) {
                        // Get the URL of the featured image
                        $thumbnail_url = get_the_post_thumbnail_url();
                    ?>
                        <img class="w-full h-full rounded-[6px] object-cover" src="<?php echo esc_url($thumbnail_url); ?>" alt="<?php the_title(); ?>">
                    <?php } else { ?>
                        <img class="w-full h-full rounded-[6px] object-cover" src="../assets/images/default-image.jpg" alt="Default Image">
                    <?php } ?>
                    <?php 
                    $terms = get_the_terms( get_the_ID(), 'category-'.$post_type );
                    if ( $terms && ! is_wp_error( $terms ) ) {
                        $term = array_shift( $terms );
                    ?>
                    <div class="absolute bottom-2 right-3 bg-blue-500 py-1 px-[14px] rounded-[9px]">
                        <span class="text-blue-200 text-sm leading-[25px] font-semibold"><?=esc_html( $term->name )?></span>
                    </div>
                    <?php } ?>
                </a>
                <a href="<?=get_post_permalink()?>" class="mt-[14px] block font-bold text-base leading-[28px] text-black-50 dark:text-dark-14">
                    <?php the_title(); ?>
                </a>
                <p class="text-black-32 font-medium text-[13px] leading-[27px] dark:text-dark-63 mt-[10px]">
                    <?php echo wp_trim_words(get_the_content(), 20, '...'); // Display trimmed content ?>
                </p>
                <div class="mt-[9px] flex items-center justify-between">
                    <p class="text-black-50 text-xs leading-[24px] font-medium dark:text-dark-14">
                        <?php echo human_time_diff(get_the_time('U'), current_time('U')) . ' قبل'; ?>
                    </p>
                    <a href="<?=get_post_permalink()?>" class="bg-blue-200 hover-element-white rounded-lg text-blue-500 text-sm leading-[17px] py-[9px] px-6 dark:bg-blue-600 dark:text-white-100" href="<?php the_permalink(); ?>">
                        خواندن مطلب
                    </a>
                </div>
            </div>
        <?php endwhile; ?>
    </div>
<?php 
else : 
    echo '<p>متاسفانه پستی پیدا نشد.</p>'; // Message if no posts found
endif; 

// Optionally reset post data if necessary
wp_reset_postdata(); 
?>
</section>
    <!-- Blogs End -->

<?php get_template_part('template-parts/pagination')?>
<?php get_template_part('template-parts/links'); ?>
<?php get_footer();